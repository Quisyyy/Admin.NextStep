<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Archive - Admin</title>
    <link rel="stylesheet" href="../style.css" />
    <link rel="stylesheet" href="adminstyle.css" />
    <script src="logo-fallback.js" defer></script>
    <script src="user-menu.js" defer></script>

    <!-- Supabase Configuration -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
      window.SUPABASE_URL = "https://ziquhxrfxywsmvunuyzi.supabase.co";
      window.SUPABASE_ANON_KEY =
        "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InppcXVoeHJmeHl3c212dW51eXppIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjIxNjM1NzQsImV4cCI6MjA3NzczOTU3NH0.IXCfC4IwcyJ5jv2jfDP2ZYfPCXUPS88kCupj0DMoVqc";
    </script>
    <script src="supabase-client.js"></script>
  </head>

  <body>
    <header class="admin-header">
      <div class="header-left">
        <div class="logo-circle small">
          <img
            src="logo/blue-orange-circle-logo-01.jpg"
            class="nav-logo"
            alt="logo"
            onerror="
              this.onerror = null;
              this.src = 'logo/blue-orange-circle-logo-01.jpg';
            "
          />
        </div>
      </div>
      <div class="header-center">NEXT STEP</div>
      <div class="header-right"><button class="user-icon">üë§</button></div>
    </header>

    <!-- Error/Success Messages Container -->
    <div
      id="messageContainer"
      style="
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        z-index: 9998;
        display: none;
      "
    >
      <div
        id="message"
        style="padding: 15px 20px; text-align: center; font-weight: 500"
      ></div>
    </div>

    <div class="admin-layout">
      <aside class="admin-sidebar">
        <nav>
          <ul>
            <li>
              <a href="homepage.html" style="color: white"
                ><span class="home-ico">üè†</span> Dashboard</a
              >
            </li>
            <li>
              <a href="audit-trail.html" style="color: white"
                ><span class="home-ico">üìã</span> Audit Trail</a
              >
            </li>
            <li class="active">
              <a href="archive.html" style="color: white"
                ><span class="home-ico">üì¶</span> Archive</a
              >
            </li>
          </ul>
        </nav>
      </aside>

      <main class="admin-main">
        <a class="back-link" href="alumlist.html">‚Üê Back to Alumni List</a>

        <div class="archive-container">
          <!-- Header Section -->
          <div class="archive-header">
            <div class="header-content">
              <h1 class="archive-title">Alumni Archive</h1>
              <p class="archive-description">
                Deleted alumni records are stored here and can be restored if
                needed. Records are automatically deleted after 30 days.
              </p>
            </div>
          </div>

          <!-- Filter Section -->
          <section class="archive-filters">
            <div class="filters-header">
              <h3>Search & Filter</h3>
            </div>
            <div class="filters-grid">
              <div class="filter-group">
                <label for="searchArchive"> Search Name/Email </label>
                <input
                  type="text"
                  id="searchArchive"
                  placeholder="Enter name or email..."
                  class="search-input"
                />
              </div>
              <div class="filter-group">
                <label for="filterArchiveStatus"> Status Filter </label>
                <select id="filterArchiveStatus" class="status-select">
                  <option value="">All Records</option>
                  <option value="archived">Archived</option>
                  <option value="restored">Restored</option>
                </select>
              </div>
              <div class="filter-actions">
                <button id="resetArchiveFilters" class="btn btn-reset">
                  Reset Filters
                </button>
              </div>
            </div>
          </section>

          <!-- Archive Stats -->
          <section class="archive-stats">
            <div class="stat-box stat-archived">
              <div class="stat-content">
                <h4>Total Archived</h4>
                <p id="totalArchived" class="stat-number">0</p>
              </div>
            </div>
            <div class="stat-box stat-restored">
              <div class="stat-content">
                <h4>Restored</h4>
                <p id="totalRestored" class="stat-number">0</p>
              </div>
            </div>
          </section>

          <!-- Cleanup Notice -->
          <section class="cleanup-notice">
            <div class="notice-content">
              <div class="notice-text">
                <p>
                  <strong>Auto-Delete Notice:</strong> Archived records will be
                  permanently deleted 30 days after archiving. You can restore
                  them before the 30-day period ends.
                </p>
              </div>
              <div class="notice-action">
                <button id="cleanupBtn" class="btn btn-danger cleanup-btn">
                  Cleanup Old Records
                </button>
              </div>
            </div>
          </section>

          <!-- Archive Table -->
          <section class="archive-table-section">
            <div class="table-header">
              <h3>Archived Records</h3>
            </div>
            <div class="table-wrap">
              <table id="archiveTable" class="archive-table">
                <thead>
                  <tr>
                    <th>Full Name</th>
                    <th>Email</th>
                    <th>Student Number</th>
                    <th>Degree</th>
                    <th>Archived Date</th>
                    <th>Reason</th>
                    <th>Status</th>
                    <th>Days Left / Actions</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td colspan="8" class="empty-state">
                      <div class="loading-content">
                        <div class="loading-spinner"></div>
                        <span>Loading archived records...</span>
                      </div>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </section>
        </div>
      </main>
    </div>

    <!-- Restore Modal -->
    <div id="restoreModal" class="modal" style="display: none">
      <div class="modal-content">
        <h2>Restore Alumni Record?</h2>
        <p id="restoreMessage">Are you sure you want to restore this record?</p>
        <div class="modal-actions">
          <button id="confirmRestoreBtn" class="btn btn-success">
            Restore
          </button>
          <button id="cancelRestoreBtn" class="btn btn-secondary">
            Cancel
          </button>
        </div>
      </div>
    </div>

    <!-- Delete Modal -->
    <div id="deleteModal" class="modal" style="display: none">
      <div class="modal-content">
        <h2>Permanently Delete Record?</h2>
        <p id="deleteMessage">
          Are you sure you want to permanently delete this record?
        </p>
        <div class="modal-actions">
          <button id="confirmDeleteBtn" class="btn btn-danger">
            Delete Permanently
          </button>
          <button id="cancelDeleteBtn" class="btn btn-secondary">Cancel</button>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="archive.js" defer></script>
    <script src="logout.js" defer></script>
  </body>
</html>
